/*******************************************************************************
 * @File: logic_calibration_table.c
 * @Author: Kozlov-dev, A.
 * @Project: Probe_LA.c * @Microcontroller: STM32F103C8T
 * @Device: Probe_LA
 * @Date: 07.04.2021
 * @Purpose: Calibration table volt2dac
 *******************************************************************************/
#define MAX_VAL_M12 88
#define MAX_VAL_M27 163

#define MAGIC_KEY_DEFINE 0x4815162342



typedef struct 
{
    /* data */
    uint32_t MagicNum; //0x4815162342

    uint16_t dacValA_m12[MAX_VAL_M12];
    uint16_t dacValB_m12[MAX_VAL_M12];
    uint16_t dacValA_m27[MAX_VAL_M27];
    uint16_t dacValB_m27[MAX_VAL_M27];
}table_t;

struct FLASH_Sector
{
    /* data */
    uint16_t data [2048-8];
    uint32_t NWrite;
    uint32_t CheckSum;
};

union NVRAM
{
    /* data */
    table_t calibration_table;
    struct FLASH_Sector sector;
    uint16_t data16[678];
}DevNVRAM;


// Чтение данных из FLASH памяти
// Если после чтения мейджик-кей не найден, то это первый запуск
if (DevNVRAM.calibration_table.MagicNum != MAGIC_KEY_DEFINE)
{
    /* code */
    Очистка даты и запись дефолтных значений
    DevNVRAM.calibration_table.dacValA_m12[0] = 
}



dacValA_m12[0] = 0;
dacValA_m12[1] = 393;
dacValA_m12[2] = 797;
dacValA_m12[3] = 547;
dacValA_m12[4] = 543;
dacValA_m12[5] = 413;
dacValA_m12[6] = 638;
dacValA_m12[7] = 663;
dacValA_m12[8] = 638;
dacValA_m12[9] = 663;
dacValA_m12[10] = 417;
dacValA_m12[11] = 547;
dacValA_m12[12] = 542;
dacValA_m12[13] = 438;
dacValA_m12[14] = 663;
dacValA_m12[15] = 392;
dacValA_m12[16] = 547;
dacValA_m12[17] = 422;
dacValA_m12[18] = 563;
dacValA_m12[19] = 667;
dacValA_m12[20] = 542;
dacValA_m12[21] = 438;
dacValA_m12[22] = 742;
dacValA_m12[23] = 563;
dacValA_m12[24] = 388;
dacValA_m12[25] = 638;
dacValA_m12[26] = 2133;
dacValA_m12[27] = 2167;
dacValA_m12[28] = 2225;
dacValA_m12[29] = 2251;
dacValA_m12[30] = 2300;
dacValA_m12[31] = 2400;
dacValA_m12[32] = 2387;
dacValA_m12[33] = 2450;
dacValA_m12[34] = 2500;
dacValA_m12[35] = 2518;
dacValA_m12[36] = 2562;
dacValA_m12[37] = 2607;
dacValA_m12[38] = 2525;
dacValA_m12[39] = 2697;
dacValA_m12[40] = 2740;
dacValA_m12[41] = 2785;
dacValA_m12[42] = 2827;
dacValA_m12[43] = 2870;
dacValA_m12[44] = 2955;
dacValA_m12[45] = 2959;
dacValA_m12[46] = 3025;
dacValA_m12[47] = 3046;
dacValA_m12[48] = 3090;
dacValA_m12[49] = 3150;
dacValA_m12[50] = 3177;
dacValA_m12[51] = 3222;
dacValA_m12[52] = 3285;
dacValA_m12[53] = 3310;
dacValA_m12[54] = 3353;
dacValA_m12[55] = 3224;
dacValA_m12[56] = 3440;
dacValA_m12[57] = 3481;
dacValA_m12[58] = 3511;
dacValA_m12[59] = 3530;
dacValA_m12[60] = 3544;
dacValA_m12[61] = 3548;
dacValA_m12[62] = 3561;
dacValA_m12[63] = 3565;
dacValA_m12[64] = 3572;
dacValA_m12[65] = 3577;
dacValA_m12[66] = 3580;
dacValA_m12[67] = 3575;
dacValA_m12[68] = 3576;
dacValA_m12[69] = 3578;
dacValA_m12[70] = 3580;
dacValA_m12[71] = 3582;
dacValA_m12[72] = 3585;
dacValA_m12[73] = 3585;
dacValA_m12[74] = 3590;
dacValA_m12[75] = 3590;
dacValA_m12[76] = 3594;
dacValA_m12[77] = 3598;
dacValA_m12[78] = 3589;
dacValA_m12[79] = 3585;
dacValA_m12[80] = 3593;
dacValA_m12[81] = 2000;
dacValA_m12[82] = 3590;
dacValA_m12[83] = 2000;
dacValA_m12[84] = 3590;
dacValA_m12[85] = 3584;
dacValA_m12[86] = 3582;
dacValA_m12[87] = 4096;

dacValB_m12[0] = 0;
dacValB_m12[1] = 443;
dacValB_m12[2] = 493;
dacValB_m12[3] = 593;
dacValB_m12[4] = 443;
dacValB_m12[5] = 493;
dacValB_m12[6] = 718;
dacValB_m12[7] = 468;
dacValB_m12[8] = 498;
dacValB_m12[9] = 473;
dacValB_m12[10] = 444;
dacValB_m12[11] = 443;
dacValB_m12[12] = 499;
dacValB_m12[13] = 473;
dacValB_m12[14] = 493;
dacValB_m12[15] = 499;
dacValB_m12[16] = 448;
dacValB_m12[17] = 449;
dacValB_m12[18] = 448;
dacValB_m12[19] = 748;
dacValB_m12[20] = 468;
dacValB_m12[21] = 593;
dacValB_m12[22] = 468;
dacValB_m12[23] = 468;
dacValB_m12[24] = 718;
dacValB_m12[25] = 459;
dacValB_m12[26] = 2135;
dacValB_m12[27] = 2167;
dacValB_m12[28] = 2212;
dacValB_m12[29] = 2255;
dacValB_m12[30] = 2299;
dacValB_m12[31] = 2342;
dacValB_m12[32] = 2388;
dacValB_m12[33] = 2432;
dacValB_m12[34] = 2476;
dacValB_m12[35] = 2520;
dacValB_m12[36] = 2564;
dacValB_m12[37] = 2608;
dacValB_m12[38] = 2651;
dacValB_m12[39] = 2694;
dacValB_m12[40] = 2738;
dacValB_m12[41] = 2783;
dacValB_m12[42] = 2827;
dacValB_m12[43] = 2870;
dacValB_m12[44] = 2915;
dacValB_m12[45] = 2958;
dacValB_m12[46] = 3050;
dacValB_m12[47] = 2813;
dacValB_m12[48] = 2961;
dacValB_m12[49] = 3133;
dacValB_m12[50] = 3177;
dacValB_m12[51] = 3006;
dacValB_m12[52] = 3266;
dacValB_m12[53] = 3360;
dacValB_m12[54] = 3353;
dacValB_m12[55] = 3396;
dacValB_m12[56] = 3438;
dacValB_m12[57] = 3474;
dacValB_m12[58] = 3351;
dacValB_m12[59] = 3525;
dacValB_m12[60] = 3522;
dacValB_m12[61] = 3531;
dacValB_m12[62] = 3540;
dacValB_m12[63] = 3545;
dacValB_m12[64] = 3593;
dacValB_m12[65] = 3178;
dacValB_m12[66] = 3004;
dacValB_m12[67] = 3165;
dacValB_m12[68] = 3151;
dacValB_m12[69] = 3294;
dacValB_m12[70] = 3154;
dacValB_m12[71] = 3550;
dacValB_m12[72] = 3583;
dacValB_m12[73] = 3589;
dacValB_m12[74] = 3595;
dacValB_m12[75] = 3200;
dacValB_m12[76] = 3103;
dacValB_m12[77] = 3597;
dacValB_m12[78] = 3191;
dacValB_m12[79] = 3401;
dacValB_m12[80] = 3413;
dacValB_m12[81] = 3317;
dacValB_m12[82] = 3604;
dacValB_m12[83] = 3455;
dacValB_m12[84] = 3370;
dacValB_m12[85] = 3409;
dacValB_m12[86] = 3552;
dacValB_m12[87] = 4096;

dacValA_m27[0] = 0;
dacValA_m27[1] = 497;
dacValA_m27[2] = 422;
dacValA_m27[3] = 542;
dacValA_m27[4] = 563;
dacValA_m27[5] = 638;
dacValA_m27[6] = 638;
dacValA_m27[7] = 443;
dacValA_m27[8] = 443;
dacValA_m27[9] = 443;
dacValA_m27[10] = 1143;
dacValA_m27[11] = 1443;
dacValA_m27[12] = 452;
dacValA_m27[13] = 443;
dacValA_m27[14] = 443;
dacValA_m27[15] = 668;
dacValA_m27[16] = 447;
dacValA_m27[17] = 443;
dacValA_m27[18] = 902;
dacValA_m27[19] = 447;
dacValA_m27[20] = 443;
dacValA_m27[21] = 643;
dacValA_m27[22] = 893;
dacValA_m27[23] = 643;
dacValA_m27[24] = 893;
dacValA_m27[25] = 893;
dacValA_m27[26] = 2115;
dacValA_m27[27] = 2115;
dacValA_m27[28] = 2110;
dacValA_m27[29] = 2153;
dacValA_m27[30] = 2160;
dacValA_m27[31] = 2167;
dacValA_m27[32] = 2009;
dacValA_m27[33] = 2019;
dacValA_m27[34] = 2148;
dacValA_m27[35] = 2048;
dacValA_m27[36] = 2148;
dacValA_m27[37] = 2088;
dacValA_m27[38] = 2252;
dacValA_m27[39] = 2258;
dacValA_m27[40] = 2044;
dacValA_m27[41] = 2148;
dacValA_m27[42] = 2044;
dacValA_m27[43] = 2303;
dacValA_m27[44] = 2174;
dacValA_m27[45] = 2100;
dacValA_m27[46] = 2088;
dacValA_m27[47] = 2119;
dacValA_m27[48] = 2048;
dacValA_m27[49] = 2173;
dacValA_m27[50] = 2378;
dacValA_m27[51] = 2423;
dacValA_m27[52] = 2014;
dacValA_m27[53] = 2148;
dacValA_m27[54] = 2420;
dacValA_m27[55] = 2319;
dacValA_m27[56] = 2269;
dacValA_m27[57] = 2164;
dacValA_m27[58] = 2004;
dacValA_m27[59] = 2019;
dacValA_m27[60] = 2024;
dacValA_m27[61] = 2324;
dacValA_m27[62] = 2515;
dacValA_m27[63] = 2329;
dacValA_m27[64] = 2299;
dacValA_m27[65] = 2020;
dacValA_m27[66] = 2155;
dacValA_m27[67] = 2068;
dacValA_m27[68] = 2083;
dacValA_m27[69] = 2086;
dacValA_m27[70] = 2223;
dacValA_m27[71] = 2052;
dacValA_m27[72] = 2628;
dacValA_m27[73] = 2031;
dacValA_m27[74] = 2288;
dacValA_m27[75] = 2131;
dacValA_m27[76] = 2004;
dacValA_m27[77] = 2304;
dacValA_m27[78] = 2377;
dacValA_m27[79] = 2385;
dacValA_m27[80] = 2688;
dacValA_m27[81] = 2098;
dacValA_m27[82] = 2201;
dacValA_m27[83] = 2169;
dacValA_m27[84] = 2753;
dacValA_m27[85] = 2231;
dacValA_m27[86] = 2269;
dacValA_m27[87] = 2000;
dacValA_m27[88] = 2199;
dacValA_m27[89] = 2003;
dacValA_m27[90] = 2379;
dacValA_m27[91] = 2281;
dacValA_m27[92] = 2281;
dacValA_m27[93] = 2010;
dacValA_m27[94] = 2102;
dacValA_m27[95] = 2050;
dacValA_m27[96] = 2102;
dacValA_m27[97] = 2050;
dacValA_m27[98] = 2252;
dacValA_m27[99] = 2275;
dacValA_m27[100] = 2252;
dacValA_m27[101] = 2327;
dacValA_m27[102] = 2327;
dacValA_m27[103] = 2353;
dacValA_m27[104] = 2352;
dacValA_m27[105] = 2965;
dacValA_m27[106] = 2960;
dacValA_m27[107] = 3010;
dacValA_m27[108] = 2402;
dacValA_m27[109] = 2450;
dacValA_m27[110] = 2450;
dacValA_m27[111] = 2475;
dacValA_m27[112] = 2452;
dacValA_m27[113] = 2719;
dacValA_m27[114] = 3024;
dacValA_m27[115] = 3050;
dacValA_m27[116] = 2502;
dacValA_m27[117] = 2865;
dacValA_m27[118] = 3100;
dacValA_m27[119] = 2540;
dacValA_m27[120] = 2552;
dacValA_m27[121] = 2575;
dacValA_m27[122] = 2554;
dacValA_m27[123] = 3142;
dacValA_m27[124] = 3139;
dacValA_m27[125] = 2590;
dacValA_m27[126] = 2610;
dacValA_m27[127] = 2610;
dacValA_m27[128] = 2617;
dacValA_m27[129] = 2640;
dacValA_m27[130] = 3248;
dacValA_m27[131] = 2650;
dacValA_m27[132] = 2660;
dacValA_m27[133] = 3248;
dacValA_m27[134] = 2678;
dacValA_m27[135] = 3263;
dacValA_m27[136] = 2700;
dacValA_m27[137] = 2709;
dacValA_m27[138] = 3289;
dacValA_m27[139] = 2730;
dacValA_m27[140] = 3019;
dacValA_m27[141] = 3023;
dacValA_m27[142] = 2763;
dacValA_m27[143] = 2785;
dacValA_m27[144] = 2795;
dacValA_m27[145] = 2795;
dacValA_m27[146] = 2796;
dacValA_m27[147] = 2804;
dacValA_m27[148] = 2812;
dacValA_m27[149] = 3128;
dacValA_m27[150] = 2840;
dacValA_m27[151] = 2833;
dacValA_m27[152] = 2855;
dacValA_m27[153] = 2853;
dacValA_m27[154] = 2860;
dacValA_m27[155] = 2865;
dacValA_m27[156] = 2885;
dacValA_m27[157] = 2902;
dacValA_m27[158] = 2900;
dacValA_m27[159] = 2902;
dacValA_m27[160] = 2915;
dacValA_m27[161] = 2914;
dacValA_m27[162] = 4096;

dacValB_m27[0] = 0;
dacValB_m27[1] = 449;
dacValB_m27[2] = 469;
dacValB_m27[3] = 469;
dacValB_m27[4] = 469;
dacValB_m27[5] = 469;
dacValB_m27[6] = 469;
dacValB_m27[7] = 469;
dacValB_m27[8] = 473;
dacValB_m27[9] = 504;
dacValB_m27[10] = 443;
dacValB_m27[11] = 443;
dacValB_m27[12] = 443;
dacValB_m27[13] = 1393;
dacValB_m27[14] = 443;
dacValB_m27[15] = 643;
dacValB_m27[16] = 463;
dacValB_m27[17] = 457;
dacValB_m27[18] = 447;
dacValB_m27[19] = 443;
dacValB_m27[20] = 543;
dacValB_m27[21] = 463;
dacValB_m27[22] = 488;
dacValB_m27[23] = 488;
dacValB_m27[24] = 463;
dacValB_m27[25] = 488;
dacValB_m27[26] = 2003;
dacValB_m27[27] = 2059;
dacValB_m27[28] = 2135;
dacValB_m27[29] = 2165;
dacValB_m27[30] = 2150;
dacValB_m27[31] = 2000;
dacValB_m27[32] = 2167;
dacValB_m27[33] = 2215;
dacValB_m27[34] = 2210;
dacValB_m27[35] = 2039;
dacValB_m27[36] = 2135;
dacValB_m27[37] = 2089;
dacValB_m27[38] = 2290;
dacValB_m27[39] = 2199;
dacValB_m27[40] = 2252;
dacValB_m27[41] = 2250;
dacValB_m27[42] = 2079;
dacValB_m27[43] = 2014;
dacValB_m27[44] = 2148;
dacValB_m27[45] = 2254;
dacValB_m27[46] = 2265;
dacValB_m27[47] = 2160;
dacValB_m27[48] = 2014;
dacValB_m27[49] = 2059;
dacValB_m27[50] = 2395;
dacValB_m27[51] = 2204;
dacValB_m27[52] = 2395;
dacValB_m27[53] = 2018;
dacValB_m27[54] = 2254;
dacValB_m27[55] = 2420;
dacValB_m27[56] = 2023;
dacValB_m27[57] = 2049;
dacValB_m27[58] = 2148;
dacValB_m27[59] = 2209;
dacValB_m27[60] = 2440;
dacValB_m27[61] = 2019;
dacValB_m27[62] = 2148;
dacValB_m27[63] = 2346;
dacValB_m27[64] = 2044;
dacValB_m27[65] = 2199;
dacValB_m27[66] = 2194;
dacValB_m27[67] = 2223;
dacValB_m27[68] = 2106;
dacValB_m27[69] = 2064;
dacValB_m27[70] = 2106;
dacValB_m27[71] = 2004;
dacValB_m27[72] = 2324;
dacValB_m27[73] = 2006;
dacValB_m27[74] = 2280;
dacValB_m27[75] = 2024;
dacValB_m27[76] = 2279;
dacValB_m27[77] = 2298;
dacValB_m27[78] = 2690;
dacValB_m27[79] = 2156;
dacValB_m27[80] = 2310;
dacValB_m27[81] = 2296;
dacValB_m27[82] = 2181;
dacValB_m27[83] = 2180;
dacValB_m27[84] = 2352;
dacValB_m27[85] = 2149;
dacValB_m27[86] = 2256;
dacValB_m27[87] = 2023;
dacValB_m27[88] = 2233;
dacValB_m27[89] = 2740;
dacValB_m27[90] = 2248;
dacValB_m27[91] = 2281;
dacValB_m27[92] = 2815;
dacValB_m27[93] = 2010;
dacValB_m27[94] = 2052;
dacValB_m27[95] = 2010;
dacValB_m27[96] = 2052;
dacValB_m27[97] = 2010;
dacValB_m27[98] = 2250;
dacValB_m27[99] = 2375;
dacValB_m27[100] = 2302;
dacValB_m27[101] = 2300;
dacValB_m27[102] = 2285;
dacValB_m27[103] = 2441;
dacValB_m27[104] = 2350;
dacValB_m27[105] = 2352;
dacValB_m27[106] = 2511;
dacValB_m27[107] = 2425;
dacValB_m27[108] = 2511;
dacValB_m27[109] = 2425;
dacValB_m27[110] = 2534;
dacValB_m27[111] = 2556;
dacValB_m27[112] = 2450;
dacValB_m27[113] = 2729;
dacValB_m27[114] = 3024;
dacValB_m27[115] = 3100;
dacValB_m27[116] = 2502;
dacValB_m27[117] = 2859;
dacValB_m27[118] = 2520;
dacValB_m27[119] = 3103;
dacValB_m27[120] = 2909;
dacValB_m27[121] = 3152;
dacValB_m27[122] = 3150;
dacValB_m27[123] = 3148;
dacValB_m27[124] = 2574;
dacValB_m27[125] = 3190;
dacValB_m27[126] = 3053;
dacValB_m27[127] = 2607;
dacValB_m27[128] = 2614;
dacValB_m27[129] = 3200;
dacValB_m27[130] = 3185;
dacValB_m27[131] = 2645;
dacValB_m27[132] = 3244;
dacValB_m27[133] = 2667;
dacValB_m27[134] = 3259;
dacValB_m27[135] = 2685;
dacValB_m27[136] = 2970;
dacValB_m27[137] = 2983;
dacValB_m27[138] = 2740;
dacValB_m27[139] = 3044;
dacValB_m27[140] = 2740;
dacValB_m27[141] = 3004;
dacValB_m27[142] = 3002;
dacValB_m27[143] = 3330;
dacValB_m27[144] = 3059;
dacValB_m27[145] = 2800;
dacValB_m27[146] = 2797;
dacValB_m27[147] = 2808;
dacValB_m27[148] = 3324;
dacValB_m27[149] = 3096;
dacValB_m27[150] = 2827;
dacValB_m27[151] = 2840;
dacValB_m27[152] = 2843;
dacValB_m27[153] = 3080;
dacValB_m27[154] = 2858;
dacValB_m27[155] = 2863;
dacValB_m27[156] = 3337;
dacValB_m27[157] = 3082;
dacValB_m27[158] = 2895;
dacValB_m27[159] = 2902;
dacValB_m27[160] = 2925;
dacValB_m27[161] = 2884;
dacValB_m27[162] = 4096;

